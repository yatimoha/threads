name: Main

on:
  push:
    branches: [ "master" ]
  workflow_dispatch:
jobs:
 build:
    runs-on: ubuntu-latest
    
    steps:
       - uses: actions/checkout@v2
       - name: Setup Node.js environment
         uses: actions/setup-node@v4.0.2
         with:
            node-version: '20.9.x'
       - name: Install dependencies
         run: npm install
       - name: Run test
         run: npm test
       - name: Run single
         run: npm "start-single"
       - name: Run multhi
         run: npm "start-multhi"
       
 deploy:
     runs-on: ubuntu-latest
     needs: [build]
     steps:
       - uses: actions/checkout@v2
       - uses: akhileshns/heroku-deploy@v3.12.12
         with:
           heroku_api_key: ${{secrets.HEROKU_API_KEY}}
           heroku_app_name: "YOUR APP's NAME" #Must be unique in Heroku
           heroku_email: "YOUR EMAIL"


    
    
